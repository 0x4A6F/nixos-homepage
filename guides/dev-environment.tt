[% WRAPPER layout.tt hideTitle=1 title="Guide: Install Nix" menu='nixos' %]

<h1>Setup a development environment</h1>

<p>As an exercise, let us build a Python web application using the Flask web framework.</p>

<p>Create a new file <code>default.nix</code>. This file is conventionally used for specifying packages:</p>

<pre class="code">
{ pkgs ? import &lt;nixpkgs&gt; {} }:

pkgs.python3Packages.buildPythonApplication {
  pname = "myapp";
  src = ./.;
  version = "0.1";
  propagatedBuildInputs = [ pkgs.python3Packages.flask ];
}
</pre>

<p>You will also need a simple Flask app as <code>main.py</code>:</p>

<pre class="code">
#! /usr/bin/env python

from flask import Flask

app = Flask(__name__)

@app.route("/")
def hello():
    return "Hello, Nix!"

def run():
    app.run(host='0.0.0.0')
</pre>

<p>and a <code>setup.py</code> script:</p>

<pre class="code">
from setuptools import setup

setup(
    name='myapp',
    version='0.1',
    py_modules=['myapp'],
    entry_points={
        'console_scripts': ['myapp = myapp:run']
    },
)
</pre>

<p>Now build the package with:</p>

<pre class="code">
nix-build
</pre>

<p>This will create a symbolic link <code>result</code> to our package's path in the Nix store, which looks like <code>/nix/store/6i4l781jwk5vbia8as32637207kgkllj-myapp-0.1</code>. Look around to see what is inside.</p>

<p>You may notice we can run the application from the package like <code>./result/bin/main.py</code>. We can still use the <code>default.nix</code> as a shell environment to get the same result:</p>

<pre class="code">
nix-shell default.nix
python3 main.py
</pre>

<p>In this context, Nix takes on the role that you would otherwise use pip or virtualenv for. Nix installs required dependencies and separates the environment from others on your system.</p>

<p>You can check this Nix configuration into version control and share it with others to make sure you are all running the same software. Especially with many dependencies this is a great way to prevent configuration drift between different team members &amp; contributors.</p>

[% END %]
